(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{162:function(e,t,a){},163:function(e,t,a){},164:function(e,t,a){},188:function(e,t,a){},191:function(e,t,a){},192:function(e,t,a){},194:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(60),i=a.n(o),l=(a(162),a(11)),c=a(12),d=a(14),r=a(13),h=a(81),b=a(16),u=(a(163),a(164),a(1)),j=function(e){Object(d.a)(a,e);var t=Object(r.a)(a);function a(e){return Object(l.a)(this,a),t.call(this,e)}return Object(c.a)(a,[{key:"render",value:function(){return Object(u.jsx)("div",{className:"navbar",children:Object(u.jsxs)("ul",{className:"navbar-list",children:[Object(u.jsx)("li",{className:"nav-item",children:Object(u.jsx)(h.b,{to:"/dashboard",children:Object(u.jsx)("a",{href:"#",className:"nav-link",children:Object(u.jsx)("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"home",className:"svg-inline--fa fa-home fa-w-18",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",children:Object(u.jsx)("path",{fill:"currentColor",d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"})})})})}),Object(u.jsx)("li",{className:"nav-item",children:Object(u.jsx)(h.b,{to:"/builder",children:Object(u.jsx)("a",{href:"#",className:"nav-link",children:Object(u.jsx)("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"cog",className:"svg-inline--fa fa-cog fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:Object(u.jsx)("path",{fill:"currentColor",d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"})})})})}),Object(u.jsx)("li",{className:"nav-item",children:Object(u.jsx)(h.b,{to:"/stat",children:Object(u.jsx)("a",{href:"#",className:"nav-link",children:Object(u.jsx)("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"far","data-icon":"chart-bar",className:"svg-inline--fa fa-chart-bar fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:Object(u.jsx)("path",{fill:"currentColor",d:"M396.8 352h22.4c6.4 0 12.8-6.4 12.8-12.8V108.8c0-6.4-6.4-12.8-12.8-12.8h-22.4c-6.4 0-12.8 6.4-12.8 12.8v230.4c0 6.4 6.4 12.8 12.8 12.8zm-192 0h22.4c6.4 0 12.8-6.4 12.8-12.8V140.8c0-6.4-6.4-12.8-12.8-12.8h-22.4c-6.4 0-12.8 6.4-12.8 12.8v198.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h22.4c6.4 0 12.8-6.4 12.8-12.8V204.8c0-6.4-6.4-12.8-12.8-12.8h-22.4c-6.4 0-12.8 6.4-12.8 12.8v134.4c0 6.4 6.4 12.8 12.8 12.8zM496 400H48V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16zm-387.2-48h22.4c6.4 0 12.8-6.4 12.8-12.8v-70.4c0-6.4-6.4-12.8-12.8-12.8h-22.4c-6.4 0-12.8 6.4-12.8 12.8v70.4c0 6.4 6.4 12.8 12.8 12.8z"})})})})})]})})}}]),a}(s.a.Component),g=a(7),m=a(15),O=a.n(m),x=(a(188),a(195)),p=a(210),v=function(e){Object(d.a)(a,e);var t=Object(r.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={bot_id:e.bot_id,messages:[],numberOfTodayUsers:0},n.getMessages=n.getMessages.bind(Object(g.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.getMessages()}},{key:"getMessages",value:function(){var e=this;O.a.get("/api/v1/bots/".concat(this.state.bot_id,"/messages?date=today")).then((function(t){window.messages=t.data,e.setState({messages:t.data}),console.log(t.data)}))}},{key:"render",value:function(){var e,t;return 0===this.props.bot.status?(e=Object(u.jsxs)("div",{className:"bot-status-row",children:[Object(u.jsx)("h4",{children:"Stopped"}),Object(u.jsx)("span",{className:"red-ball"})]}),t=Object(u.jsx)(x.a,{fluid:!0,color:"green",onClick:this.props.startBotFunc,children:"Start"})):1===this.props.bot.status&&(e=Object(u.jsxs)("div",{className:"bot-status-row",children:[Object(u.jsx)("h4",{children:"Running"}),Object(u.jsx)("span",{className:"ok-ball"})]}),t=Object(u.jsx)(x.a,{fluid:!0,color:"red",onClick:this.props.stopBotFunc,children:"Stop"})),Object(u.jsxs)(p.a,{color:"red",children:[Object(u.jsx)(p.a.Content,{children:Object(u.jsxs)(p.a.Header,{children:[this.props.bot.username," status"]})}),Object(u.jsxs)(p.a.Content,{id:"bot-status-card",children:[e,Object(u.jsxs)("h5",{children:["Today received: ",this.state.messages.length," messages"]})]}),Object(u.jsx)(p.a.Content,{extra:!0,children:t})]})}}]),a}(s.a.Component),y=a(213),f=function(e){Object(d.a)(a,e);var t=Object(r.a)(a);function a(e){var n;Object(l.a)(this,a),n=t.call(this,e);var s=localStorage.getItem("user_id"),o=localStorage.getItem("bot_id");return n.state={bot:{},loading:!0,user_id:s,bot_id:o,messages:[]},n.startBot=n.startBot.bind(Object(g.a)(n)),n.stopBot=n.stopBot.bind(Object(g.a)(n)),n.getMessages=n.getMessages.bind(Object(g.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;O.a.get("/api/v1/bots/".concat(this.state.bot_id,"/")).then((function(t){console.log(t.data),e.setState({bot:t.data,loading:!1})})),this.getMessages()}},{key:"startBot",value:function(){var e=this;O.a.get("/api/v1/bots/".concat(this.state.bot_id,"/start/")).then((function(t){console.log(t.data),e.setState({bot:t.data})}))}},{key:"stopBot",value:function(){var e=this;O.a.get("/api/v1/bots/".concat(this.state.bot_id,"/stop/")).then((function(t){e.setState({bot:t.data})}))}},{key:"getMessages",value:function(){var e=this;O.a.get("/api/v1/bots/".concat(this.state.bot_id,"/messages?date=today")).then((function(t){window.messages=t.data,e.setState({messages:t.data}),console.log(t.data)}))}},{key:"login",value:function(){O.a.post("/api/v1/login/",{email:"brebiv@gmail.com",password:"10891089"}).then((function(e){localStorage.setItem("user_id",e.data.user_id),localStorage.setItem("bot_id",e.data.bot_id),document.location.href="/dashboard"}))}},{key:"logout",value:function(){O.a.get("/api/v1/logout/").then((function(e){console.log(e.data),localStorage.removeItem("user_id"),localStorage.removeItem("bot_id"),document.location.href="/"}))}},{key:"render",value:function(){var e=this;return Object(u.jsxs)("main",{children:[Object(u.jsxs)(y.a,{compact:!0,secondary:!0,children:[Object(u.jsx)("h1",{children:"Dashboard"}),Object(u.jsx)(x.a,{onClick:function(){return e.logout()},children:"Logout"})]}),this.state.loading?Object(u.jsx)("h1",{children:"Loading"}):Object(u.jsx)(v,{bot:this.state.bot,startBotFunc:this.startBot,stopBotFunc:this.stopBot,bot_id:this.state.bot_id})]})}}]),a}(s.a.Component),k=a(208),C=a(211),w=a(44),M=a(207),_=a(206),I=a(209),F=function(e){Object(d.a)(a,e);var t=Object(r.a)(a);function a(e){var n;Object(l.a)(this,a),n=t.call(this,e);var s=e.editable.trigger,o=e.editable.reply_text,i=s.slice(1);return n.state={commandWithoutSlash:i,trigger:s,reply_text:o,command:e.editable},n.handleTriggerInputChange=n.handleTriggerInputChange.bind(Object(g.a)(n)),n.handleReplyTextChange=n.handleReplyTextChange.bind(Object(g.a)(n)),n.handleImageInputChange=n.handleImageInputChange.bind(Object(g.a)(n)),n}return Object(c.a)(a,[{key:"handleTriggerInputChange",value:function(e){var t=this.state.command;t.trigger="/"+e.target.value,this.setState({command:t})}},{key:"handleReplyTextChange",value:function(e){var t=this.state.command;t.reply_text=e.target.value,this.setState({command:t})}},{key:"handleImageInputChange",value:function(e){var t=this.state.command;t.reply_img_url=e.target.value,this.setState({command:t})}},{key:"render",value:function(){var e=this,t="";return this.state.command.reply_img_url&&(t=Object(u.jsxs)(M.a.Field,{children:[Object(u.jsx)("label",{children:"Image url"}),Object(u.jsx)(_.a,{type:"url",defaultValue:this.state.command.reply_img_url,onChange:this.handleImageInputChange})]})),Object(u.jsxs)(I.a,{open:!0,children:[Object(u.jsx)(I.a.Header,{children:"Edit"}),Object(u.jsx)(I.a.Content,{children:Object(u.jsx)(I.a.Description,{children:Object(u.jsxs)(M.a,{children:[Object(u.jsxs)(M.a.Field,{children:[Object(u.jsx)("label",{children:"Trigger"}),Object(u.jsx)(_.a,{type:"text",label:"/",defaultValue:this.state.commandWithoutSlash,onChange:this.handleTriggerInputChange})]}),Object(u.jsxs)(M.a.Field,{children:[Object(u.jsx)("label",{children:"Response"}),Object(u.jsx)(_.a,{type:"text",defaultValue:this.state.reply_text,onChange:this.handleReplyTextChange})]}),t]})})}),Object(u.jsxs)(I.a.Actions,{children:[Object(u.jsx)(x.a,{content:"Delete",onClick:function(){return e.props.deleteCommandFunc(e.state)},color:"red",floated:"left"}),Object(u.jsx)(x.a,{color:"black",onClick:this.props.closeFunc,children:"Close"}),Object(u.jsx)(x.a,{content:"Change",onClick:function(){return e.props.submitFunc(e.state)},primary:!0})]})]})}}]),a}(s.a.Component),S=(a(191),a(192),function(e){Object(d.a)(a,e);var t=Object(r.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={buttons:e.buttons,showAddButtonModal:!1},n}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(e){e.buttons!==this.props.buttons&&this.setState({buttons:this.props.buttons})}},{key:"render",value:function(){var e=[];return this.state.buttons.forEach((function(t){e.push(Object(u.jsx)("div",{className:"keyboard-button",children:Object(u.jsx)("p",{className:"button-text",children:t.text})}))})),Object(u.jsx)("div",{className:"keyboard-wrapper",children:Object(u.jsxs)("div",{className:"keyboard-selector",children:[e,Object(u.jsx)("div",{className:"keyboard-button",id:"add-button",onClick:this.props.addButtonClickHandler,children:Object(u.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:Object(u.jsx)("path",{d:"M24 10h-10v-10h-4v10h-10v4h10v10h4v-10h10z"})})})]})})}}]),a}(s.a.Component)),A=a(87),E=function(e){Object(d.a)(a,e);var t=Object(r.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={text:"",url:"",callback_data:""},n.handleButtonTextChange=n.handleButtonTextChange.bind(Object(g.a)(n)),n.handleUrlChange=n.handleUrlChange.bind(Object(g.a)(n)),n.handleCallbackDataChange=n.handleCallbackDataChange.bind(Object(g.a)(n)),n}return Object(c.a)(a,[{key:"handleButtonTextChange",value:function(e){this.setState({text:e.target.value})}},{key:"handleUrlChange",value:function(e){this.setState({url:e.target.value})}},{key:"handleCallbackDataChange",value:function(e){this.setState({callback_data:e.target.value})}},{key:"render",value:function(){var e,t,a=this;return this.state.showTriggerInputError&&(e={content:"MY ERROR",pointing:"below"}),t=""===this.state.text||""===this.state.callback_data?Object(u.jsx)(x.a,{content:"Add",labelPosition:"right",icon:"checkmark",disabled:!0,primary:!0}):Object(u.jsx)(x.a,{content:"Add",labelPosition:"right",icon:"checkmark",onClick:function(){return a.props.submitFunc(a.state)},primary:!0}),Object(u.jsx)("div",{children:Object(u.jsxs)(I.a,{open:!0,size:"small",children:[Object(u.jsx)(I.a.Header,{children:"Add button"}),Object(u.jsx)(I.a.Content,{children:Object(u.jsx)(I.a.Description,{children:Object(u.jsxs)(M.a,{children:[Object(u.jsxs)(M.a.Field,{error:e,children:[Object(u.jsx)("label",{children:"Button text"}),Object(u.jsx)(_.a,{type:"text",onChange:this.handleButtonTextChange})]}),Object(u.jsxs)(M.a.Field,{children:[Object(u.jsxs)("label",{children:["URL",Object(u.jsx)(A.a,{style:{marginLeft:"1rem"},color:"purple",children:"Optional"})]}),Object(u.jsx)(_.a,{type:"url",onChange:this.handleUrlChange})]}),Object(u.jsxs)(M.a.Field,{children:[Object(u.jsx)("label",{children:"Callback data"}),Object(u.jsx)(_.a,{type:"text",onChange:this.handleCallbackDataChange})]}),Object(u.jsx)(M.a.Field,{})]})})}),Object(u.jsxs)(I.a.Actions,{children:[Object(u.jsx)(x.a,{color:"black",onClick:this.props.closeFunc,children:"Close"}),t]})]})})}}]),a}(s.a.Component),T=function(e){Object(d.a)(a,e);var t=Object(r.a)(a);function a(e){var n;Object(l.a)(this,a);return(n=t.call(this,e)).state={keyboard:null,buttons:[],showTriggerInputError:!1,showImageField:!1,showKeyboardField:!1,showAddButtonModal:!1},n.toggleAddButtonModal=n.toggleAddButtonModal.bind(Object(g.a)(n)),n.showAddButtonModal=n.showAddButtonModal.bind(Object(g.a)(n)),n.hideAddButtonModal=n.hideAddButtonModal.bind(Object(g.a)(n)),n.submitAddButtonModal=n.submitAddButtonModal.bind(Object(g.a)(n)),n}return Object(c.a)(a,[{key:"toggleAddButtonModal",value:function(e){!0===e?this.setState({showAddButtonModal:!0}):!1===e&&this.setState({showAddButtonModal:!1})}},{key:"showAddButtonModal",value:function(){this.setState({showAddButtonModal:!0})}},{key:"hideAddButtonModal",value:function(){this.setState({showAddButtonModal:!1})}},{key:"submitAddButtonModal",value:function(e){var t={text:e.text,url:e.url,callback_data:e.callback_data};console.info(t);var a=this.state.buttons.concat(t);console.info(a),this.setState({buttons:a}),this.hideAddButtonModal()}},{key:"render",value:function(){var e,t=this;return this.state.buttons.length<=0?e=Object(u.jsx)(x.a,{content:"Save",labelPosition:"right",icon:"checkmark",disabled:!0,primary:!0}):this.state.buttons.length>0&&(e=Object(u.jsx)(x.a,{content:"Save",labelPosition:"right",icon:"checkmark",onClick:function(){return t.props.submitFunc(t.state)},primary:!0})),Object(u.jsxs)("div",{children:[this.state.showAddButtonModal&&Object(u.jsx)(E,{closeFunc:this.hideAddButtonModal,submitFunc:this.submitAddButtonModal}),Object(u.jsxs)(I.a,{open:!0,size:"small",children:[Object(u.jsx)(I.a.Header,{children:"Add keyboard"}),Object(u.jsx)(I.a.Content,{children:Object(u.jsx)(S,{buttons:this.state.buttons,addButtonClickHandler:this.showAddButtonModal})}),Object(u.jsxs)(I.a.Actions,{children:[Object(u.jsx)(x.a,{color:"black",onClick:this.props.closeFunc,children:"Close"}),e]})]})]})}}]),a}(s.a.Component),B=function(e){Object(d.a)(a,e);var t=Object(r.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={trigger:"",reply_text:"",image_url:"",keyboard:null,buttons:[],showTriggerInputError:!1,showImageField:!1,showKeyboardField:!1,showKeyboardModal:!1},n.handleTriggerInputChange=n.handleTriggerInputChange.bind(Object(g.a)(n)),n.handleReplyTextChange=n.handleReplyTextChange.bind(Object(g.a)(n)),n.handleImageInputChange=n.handleImageInputChange.bind(Object(g.a)(n)),n.addImageField=n.addImageField.bind(Object(g.a)(n)),n.removeImageField=n.removeImageField.bind(Object(g.a)(n)),n.addKeyboardField=n.addKeyboardField.bind(Object(g.a)(n)),n.removeKeyboardField=n.removeKeyboardField.bind(Object(g.a)(n)),n.showKeyboardModal=n.showKeyboardModal.bind(Object(g.a)(n)),n.hideKeyboardModal=n.hideKeyboardModal.bind(Object(g.a)(n)),n.submitKeyboardModal=n.submitKeyboardModal.bind(Object(g.a)(n)),n}return Object(c.a)(a,[{key:"handleTriggerInputChange",value:function(e){/^[a-zA-Z0-9]+$/.test(e.target.value)?(this.setState({trigger:e.target.value}),this.setState({showTriggerInputError:!1}),console.log("TRUE")):(this.setState({trigger:e.target.value}),this.setState({showTriggerInputError:!0}),console.log("FALSE"))}},{key:"handleImageInputChange",value:function(e){this.setState({image_url:e.target.value})}},{key:"handleReplyTextChange",value:function(e){this.setState({reply_text:e.target.value})}},{key:"addImageField",value:function(){this.setState({showImageField:!0})}},{key:"removeImageField",value:function(){this.setState({showImageField:!1,image_url:""})}},{key:"addKeyboardField",value:function(){this.setState({showKeyboardField:!0})}},{key:"removeKeyboardField",value:function(){this.setState({showKeyboardField:!1,keyboard:null,buttons:[]})}},{key:"showKeyboardModal",value:function(){this.setState({showKeyboardModal:!0})}},{key:"hideKeyboardModal",value:function(){this.setState({showKeyboardModal:!1})}},{key:"submitKeyboardModal",value:function(e){this.addKeyboardField(),this.hideKeyboardModal(),console.info(e),this.setState({buttons:e.buttons})}},{key:"render",value:function(){var e,t,a=this;this.state.showTriggerInputError&&(e={content:"MY ERROR",pointing:"below"}),this.state.showTriggerInputError||""===this.state.reply_text?t=Object(u.jsx)(x.a,{content:"Add",labelPosition:"right",icon:"checkmark",disabled:!0,primary:!0}):this.state.showTriggerInputError||""===this.state.reply_text||(t=Object(u.jsx)(x.a,{content:"Add",labelPosition:"right",icon:"checkmark",onClick:function(){return a.props.submitFunc(a.state)},primary:!0}));var n="";this.state.showImageField&&(n=Object(u.jsxs)(M.a.Field,{children:[Object(u.jsx)("label",{children:"Image url"}),Object(u.jsx)(_.a,{type:"url",defaultValue:this.state.image_url,onChange:this.handleImageInputChange})]}));var s="";this.state.showKeyboardField&&(s=Object(u.jsx)(M.a.Field,{children:Object(u.jsx)(x.a,{content:"Edit keyboard",labelPosition:"right",icon:"keyboard",onClick:function(){return console.info("Soon")},color:"teal"})}));var o=Object(u.jsx)(x.a,{content:"Add image",labelPosition:"right",icon:"image",onClick:this.addImageField,primary:!0}),i=Object(u.jsx)(x.a,{content:"Add keyboard",labelPosition:"right",icon:"keyboard",onClick:function(){a.showKeyboardModal()},primary:!0});return this.state.showImageField&&(o=Object(u.jsx)(x.a,{content:"Remove image",labelPosition:"right",icon:"image",onClick:this.removeImageField,primary:!0})),this.state.showKeyboardField&&(i=Object(u.jsx)(x.a,{content:"Remove keyboard",labelPosition:"right",icon:"keyboard",onClick:this.removeKeyboardField,primary:!0})),Object(u.jsxs)("div",{children:[this.state.showKeyboardModal&&Object(u.jsx)(T,{submitFunc:this.submitKeyboardModal,closeFunc:this.hideKeyboardModal}),Object(u.jsxs)(I.a,{open:!0,children:[Object(u.jsx)(I.a.Header,{children:"Add"}),Object(u.jsx)(I.a.Content,{children:Object(u.jsx)(I.a.Description,{children:Object(u.jsxs)(M.a,{children:[Object(u.jsxs)(M.a.Field,{error:e,children:[Object(u.jsx)("label",{children:"Trigger"}),Object(u.jsx)(_.a,{type:"text",label:"/",defaultValue:this.state.commandWithoutSlash,onChange:this.handleTriggerInputChange})]}),Object(u.jsxs)(M.a.Field,{children:[Object(u.jsx)("label",{children:"Response"}),Object(u.jsx)(_.a,{type:"text",defaultValue:this.state.reply_text,onChange:this.handleReplyTextChange})]}),n,s,Object(u.jsxs)(M.a.Field,{children:[o,i]})]})})}),Object(u.jsxs)(I.a.Actions,{children:[Object(u.jsx)(x.a,{color:"black",onClick:this.props.closeFunc,children:"Close"}),t]})]})]})}}]),a}(s.a.Component),K=function(e){Object(d.a)(a,e);var t=Object(r.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={trigger:"",reply_text:"",image_url:"",callback_datas:e.callback_datas,showTriggerInputError:!1,showImageField:!1,showKeyboardField:!1,showKeyboardModal:!1},console.log(e.callback_datas),n.handleTriggerInputChange=n.handleTriggerInputChange.bind(Object(g.a)(n)),n.handleReplyTextChange=n.handleReplyTextChange.bind(Object(g.a)(n)),n.handleImageInputChange=n.handleImageInputChange.bind(Object(g.a)(n)),n.addImageField=n.addImageField.bind(Object(g.a)(n)),n.removeImageField=n.removeImageField.bind(Object(g.a)(n)),n.addKeyboardField=n.addKeyboardField.bind(Object(g.a)(n)),n.removeKeyboardField=n.removeKeyboardField.bind(Object(g.a)(n)),n.showKeyboardModal=n.showKeyboardModal.bind(Object(g.a)(n)),n.hideKeyboardModal=n.hideKeyboardModal.bind(Object(g.a)(n)),n.submitKeyboardModal=n.submitKeyboardModal.bind(Object(g.a)(n)),n}return Object(c.a)(a,[{key:"handleTriggerInputChange",value:function(e){this.setState({trigger:e.target.value})}},{key:"handleImageInputChange",value:function(e){this.setState({image_url:e.target.value})}},{key:"handleReplyTextChange",value:function(e){this.setState({reply_text:e.target.value})}},{key:"addImageField",value:function(){this.setState({showImageField:!0})}},{key:"removeImageField",value:function(){this.setState({showImageField:!1,image_url:""})}},{key:"addKeyboardField",value:function(){this.setState({showKeyboardField:!0})}},{key:"removeKeyboardField",value:function(){this.setState({showKeyboardField:!1,keyboard:null,buttons:[]})}},{key:"showKeyboardModal",value:function(){this.setState({showKeyboardModal:!0})}},{key:"hideKeyboardModal",value:function(){this.setState({showKeyboardModal:!1})}},{key:"submitKeyboardModal",value:function(e){this.addKeyboardField(),this.hideKeyboardModal(),console.info(e),this.setState({buttons:e.buttons})}},{key:"render",value:function(){var e,t,a=this;this.state.showTriggerInputError&&(e={content:"MY ERROR",pointing:"below"}),this.state.showTriggerInputError||""===this.state.reply_text?t=Object(u.jsx)(x.a,{content:"Add",labelPosition:"right",icon:"checkmark",disabled:!0,primary:!0}):this.state.showTriggerInputError||""===this.state.reply_text||(t=Object(u.jsx)(x.a,{content:"Add",labelPosition:"right",icon:"checkmark",onClick:function(){return a.props.submitFunc(a.state)},primary:!0}));var n="";this.state.showImageField&&(n=Object(u.jsxs)(M.a.Field,{children:[Object(u.jsx)("label",{children:"Image url"}),Object(u.jsx)(_.a,{type:"url",defaultValue:this.state.image_url,onChange:this.handleImageInputChange})]}));var s=Object(u.jsx)(x.a,{content:"Add image",labelPosition:"right",icon:"image",onClick:this.addImageField,primary:!0});this.state.showImageField&&(s=Object(u.jsx)(x.a,{content:"Remove image",labelPosition:"right",icon:"image",onClick:this.removeImageField,primary:!0}));var o=[];return this.state.callback_datas.forEach((function(e){o.push(Object(u.jsx)("option",{value:e,children:e}))})),Object(u.jsx)("div",{children:Object(u.jsxs)(I.a,{open:!0,children:[Object(u.jsx)(I.a.Header,{children:"Add callback"}),Object(u.jsx)(I.a.Content,{children:Object(u.jsx)(I.a.Description,{children:Object(u.jsxs)(M.a,{children:[Object(u.jsxs)(M.a.Field,{error:e,children:[Object(u.jsx)("label",{children:"Trigger"}),Object(u.jsx)("select",{onChange:this.handleTriggerInputChange,name:"cars",children:o})]}),Object(u.jsxs)(M.a.Field,{children:[Object(u.jsx)("label",{children:"Response"}),Object(u.jsx)(_.a,{type:"text",defaultValue:this.state.reply_text,onChange:this.handleReplyTextChange})]}),n,Object(u.jsx)(M.a.Field,{children:s})]})})}),Object(u.jsxs)(I.a.Actions,{children:[Object(u.jsx)(x.a,{color:"black",onClick:this.props.closeFunc,children:"Close"}),t]})]})})}}]),a}(s.a.Component),R=function(e){Object(d.a)(a,e);var t=Object(r.a)(a);function a(e){var n;Object(l.a)(this,a),n=t.call(this,e);var s=e.editable.trigger,o=e.editable.reply_text,i=s.slice(1);return n.state={commandWithoutSlash:i,trigger:s,reply_text:o,editable:e.editable},n.handleTriggerInputChange=n.handleTriggerInputChange.bind(Object(g.a)(n)),n.handleReplyTextChange=n.handleReplyTextChange.bind(Object(g.a)(n)),n.handleImageInputChange=n.handleImageInputChange.bind(Object(g.a)(n)),n}return Object(c.a)(a,[{key:"handleTriggerInputChange",value:function(e){var t=this.state.editable;t.trigger="/"+e.target.value,this.setState({command:t})}},{key:"handleReplyTextChange",value:function(e){var t=this.state.editable;t.reply_text=e.target.value,this.setState({command:t})}},{key:"handleImageInputChange",value:function(e){var t=this.state.editable;t.reply_img_url=e.target.value,this.setState({command:t})}},{key:"render",value:function(){var e=this,t="";return this.state.editable.reply_img_url&&(t=Object(u.jsxs)(M.a.Field,{children:[Object(u.jsx)("label",{children:"Image url"}),Object(u.jsx)(_.a,{type:"url",defaultValue:this.state.editable.reply_img_url,onChange:this.handleImageInputChange})]})),Object(u.jsxs)(I.a,{open:!0,children:[Object(u.jsx)(I.a.Header,{children:"Edit callback"}),Object(u.jsx)(I.a.Content,{children:Object(u.jsx)(I.a.Description,{children:Object(u.jsxs)(M.a,{children:[Object(u.jsxs)(M.a.Field,{children:[Object(u.jsx)("label",{children:"Trigger"}),Object(u.jsx)(_.a,{type:"text",label:"/",defaultValue:this.state.commandWithoutSlash,onChange:this.handleTriggerInputChange})]}),Object(u.jsxs)(M.a.Field,{children:[Object(u.jsx)("label",{children:"Response"}),Object(u.jsx)(_.a,{type:"text",defaultValue:this.state.reply_text,onChange:this.handleReplyTextChange})]}),t]})})}),Object(u.jsxs)(I.a.Actions,{children:[Object(u.jsx)(x.a,{content:"Delete",onClick:function(){return e.props.deleteFunc(e.state.editable)},color:"red",floated:"left"}),Object(u.jsx)(x.a,{color:"black",onClick:this.props.closeFunc,children:"Close"}),Object(u.jsx)(x.a,{content:"Change",onClick:function(){return e.props.submitFunc(e.state)},primary:!0})]})]})}}]),a}(s.a.Component),D=a(108),U=a.n(D),N=function(e){Object(d.a)(a,e);var t=Object(r.a)(a);function a(e){var n;Object(l.a)(this,a),n=t.call(this,e);var s=localStorage.getItem("user_id"),o=localStorage.getItem("bot_id");return n.state={bot:void 0,bot_id:o,user_id:s,commands:[],callbacks:[],callback_datas:[],loading:!0,showEditModal:!1,editId:void 0,showAddModal:!1,showAddCallbackModal:!1,showEditCallbackModal:!1},n.getCommands=n.getCommands.bind(Object(g.a)(n)),n.getCallbacks=n.getCallbacks.bind(Object(g.a)(n)),n.submitEditModal=n.submitEditModal.bind(Object(g.a)(n)),n.closeEditModal=n.closeEditModal.bind(Object(g.a)(n)),n.submitAddModal=n.submitAddModal.bind(Object(g.a)(n)),n.closeAddModal=n.closeAddModal.bind(Object(g.a)(n)),n.submitAddCallbackModal=n.submitAddCallbackModal.bind(Object(g.a)(n)),n.closeAddCallbackModal=n.closeAddCallbackModal.bind(Object(g.a)(n)),n.addCommand=n.addCommand.bind(Object(g.a)(n)),n.addCallbackHandler=n.addCallbackHandler.bind(Object(g.a)(n)),n.deleteCommand=n.deleteCommand.bind(Object(g.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){if(this.getCommands(),this.getCallbacks(),null!=this.state.user_id){var e=U.a.get("csrftoken");console.info("[DEBUG] Got csrf from cookie:",e),O.a.defaults.headers.common["X-CSRFToken"]=e}}},{key:"getCommands",value:function(){var e=this;O.a.get("api/v1/bots/".concat(this.state.bot_id,"/commands/")).then((function(t){console.info("[DEBUG] getCommands resp data:",t.data),e.setState({commands:t.data});var a=[];t.data.forEach((function(e){e.buttons.forEach((function(e){a.push(e.callback_data)}))})),e.setState({callback_datas:a}),console.log("Callback datas",a)}))}},{key:"getCallbacks",value:function(){var e=this;O.a.get("api/v1/bots/".concat(this.state.bot_id,"/callbacks")).then((function(t){console.info("[DEBUG] getCallbacks resp data:",t.data),e.setState({callbacks:t.data})}))}},{key:"getInlineKeyboardButtons",value:function(e){O.a.get("api/v1/commands/".concat(e,"/inline_buttons/")).then((function(e){console.log("DATA",e)}))}},{key:"handleEditCommandClick",value:function(e){console.log("[DEBUG] Command to edit:".command),this.setState({editCommand:e,showEditModal:!0})}},{key:"handleEditCallbackClick",value:function(e){console.log("[DEBUG] Callback to edit:",e),this.setState({editCallback:e,showEditCallbackModal:!0})}},{key:"addCommand",value:function(e){var t=this;O.a.post("api/v1/bots/".concat(this.state.bot_id,"/commands/"),{trigger:"/"+e.trigger,reply_text:e.reply_text,reply_img_url:e.image_url,buttons:e.buttons,bot_id:this.state.bot_id,owner_id:this.state.user_id}).then((function(e){var a=t.state.commands.concat(e.data);console.info(a),t.setState({commands:a})}))}},{key:"editCommand",value:function(e){O.a.put("api/v1/commands/".concat(e.id,"/"),e).then((function(e){window.location.reload()}))}},{key:"deleteCommand",value:function(e){var t=this;console.log("[DEBUG] Delete command"),console.log(e),O.a.delete("api/v1/commands/".concat(e.command.id,"/")).then((function(e){t.getCommands(),t.setState({showEditModal:!1})}))}},{key:"deleteCallback",value:function(e){var t=this;console.log("[DEBUG] Delete callback",e),O.a.delete("api/v1/callbacks/".concat(e.id)).then((function(e){t.getCallbacks(),t.setState({showEditCallbackModal:!1})}))}},{key:"submitEditModal",value:function(e){console.log("[DEBUG] Submit edit modal"),this.setState({showEditModal:!1}),console.log(e),this.editCommand(e.command)}},{key:"closeEditModal",value:function(){console.log("[DEBUG] Close edit modal"),this.setState({showEditModal:!1})}},{key:"submitAddModal",value:function(e){console.log("[DEBUG] Submit add modal"),this.setState({showAddModal:!1}),console.log(e),this.addCommand(e)}},{key:"submitAddCallbackModal",value:function(e){console.log("[DEBUG] Submit add callback modal"),this.setState({showAddCallbackModal:!1}),this.addCallbackHandler(e)}},{key:"closeAddModal",value:function(){this.setState({showAddModal:!1})}},{key:"addCallbackHandler",value:function(e){O.a.post("api/v1/bots/".concat(this.state.bot_id,"/callbacks/"),{trigger:e.trigger,reply_text:e.reply_text,reply_img_url:e.image_url,bot_id:this.state.bot_id})}},{key:"closeAddCallbackModal",value:function(){this.setState({showAddCallbackModal:!1})}},{key:"render",value:function(){var e=this,t=[],a=[];return this.state.commands.forEach((function(a){t.push(Object(u.jsxs)(k.a.Item,{children:[Object(u.jsx)(k.a.Content,{floated:"right",children:Object(u.jsx)(x.a,{onClick:function(){return e.handleEditCommandClick(a)},children:"Edit"})}),Object(u.jsx)(k.a.Content,{children:Object(u.jsx)("h4",{children:a.trigger})})]}))})),this.state.callbacks.forEach((function(t){a.push(Object(u.jsxs)(k.a.Item,{children:[Object(u.jsx)(k.a.Content,{floated:"right",children:Object(u.jsx)(x.a,{onClick:function(){return e.handleEditCallbackClick(t)},children:"Edit"})}),Object(u.jsx)(k.a.Content,{children:Object(u.jsx)("h4",{children:t.trigger})})]}))})),Object(u.jsxs)("main",{children:[this.state.showEditModal&&Object(u.jsx)(F,{submitFunc:this.submitEditModal,closeFunc:this.closeEditModal,deleteCommandFunc:this.deleteCommand,editable:this.state.editCommand}),this.state.showAddModal&&Object(u.jsx)(B,{submitFunc:this.submitAddModal,closeFunc:this.closeAddModal}),this.state.showAddCallbackModal&&Object(u.jsx)(K,{submitFunc:this.submitAddCallbackModal,closeFunc:this.closeAddCallbackModal,callback_datas:this.state.callback_datas}),this.state.showEditCallbackModal&&Object(u.jsx)(R,{closeFunc:function(){return e.setState({showEditCallbackModal:!1})},deleteFunc:function(t){return e.deleteCallback(t)},editable:this.state.editCallback}),Object(u.jsx)(y.a,{compact:!0,secondary:!0,children:Object(u.jsx)("h1",{children:"Builder"})}),Object(u.jsxs)(C.a,{columns:2,relaxed:"very",id:"builder-grid",children:[Object(u.jsxs)(C.a.Column,{class:"builder-column",children:[Object(u.jsx)(y.a,{secondary:!0,attached:"top",children:Object(u.jsx)("h4",{children:"Commands"})}),Object(u.jsx)(y.a,{attached:!0,children:Object(u.jsx)(k.a,{divided:!0,verticalAlign:"middle",className:"scrolling-list",children:this.state.commands.length>0?t:Object(u.jsx)("h2",{children:"No commands"})})}),Object(u.jsx)(y.a,{secondary:!0,clearing:!0,attached:"bottom",children:Object(u.jsxs)(x.a,{floated:"right",icon:!0,labelPosition:"left",primary:!0,size:"small",onClick:function(){return e.setState({showAddModal:!0})},children:[Object(u.jsx)(w.a,{name:"add"}),"Add"]})})]}),Object(u.jsxs)(C.a.Column,{children:[Object(u.jsx)(y.a,{secondary:!0,attached:"top",children:Object(u.jsx)("h4",{children:"Callbacks"})}),Object(u.jsx)(y.a,{attached:!0,children:Object(u.jsx)(k.a,{divided:!0,verticalAlign:"middle",className:"scrolling-list",children:this.state.callbacks.length>0?a:Object(u.jsx)("h2",{children:"No callbacks"})})}),Object(u.jsx)(y.a,{secondary:!0,clearing:!0,attached:"bottom",children:Object(u.jsxs)(x.a,{floated:"right",icon:!0,labelPosition:"left",primary:!0,size:"small",onClick:function(){return e.setState({showAddCallbackModal:!0})},children:[Object(u.jsx)(w.a,{name:"add"}),"Add"]})})]})]})]})}}]),a}(s.a.Component),V=a(147),H=function(e){Object(d.a)(a,e);var t=Object(r.a)(a);function a(e){var n;Object(l.a)(this,a),n=t.call(this,e);var s=localStorage.getItem("user_id"),o=localStorage.getItem("bot_id");return n.state={bot:{},loading:!0,user_id:s,bot_id:o,messages:[],numberOfTodayUsers:0},n.getMessages=n.getTodayMessages.bind(Object(g.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.getTodayMessages()}},{key:"getTodayMessages",value:function(){var e=this;O.a.get("/api/v1/bots/".concat(this.state.bot_id,"/messages?date=today")).then((function(t){window.messages=t.data;var a=t.data,n=[];a.forEach((function(e){n.includes(e.sender_tid)||n.push(e.sender_tid)})),e.setState({messages:t.data,numberOfTodayUsers:n.length}),console.log(t.data)}))}},{key:"getAllMessages",value:function(){O.a.get("/api/v1/bots/".concat(this.state.bot_id,"/messages")).then((function(e){}))}},{key:"render",value:function(){return Object(u.jsxs)("main",{children:[Object(u.jsx)(y.a,{compact:!0,secondary:!0,children:Object(u.jsx)("h1",{children:"Statistics"})}),Object(u.jsxs)(p.a,{color:"red",children:[Object(u.jsx)(p.a.Content,{children:Object(u.jsx)(p.a.Header,{children:"Statistics"})}),Object(u.jsxs)(p.a.Content,{id:"bot-status-card",children:[Object(u.jsxs)("h5",{children:["Today received: ",this.state.messages.length," messages"]}),Object(u.jsxs)("h5",{children:["Today users: ",this.state.numberOfTodayUsers]})]}),Object(u.jsx)(p.a.Content,{extra:!0,children:"Conclusion: You're doing fine"})]}),Object(u.jsxs)(p.a,{color:"red",children:[Object(u.jsx)(p.a.Content,{children:Object(u.jsx)(p.a.Header,{children:"Statistics"})}),Object(u.jsx)(p.a.Content,{id:"bot-status-card",children:Object(u.jsx)(V.a,{src:"/interactive-line-graph.png"})}),Object(u.jsx)(p.a.Content,{extra:!0,children:"Graph says everything is going great"})]})]})}}]),a}(s.a.Component),P=function(e){Object(d.a)(a,e);var t=Object(r.a)(a);function a(e){var n;Object(l.a)(this,a),n=t.call(this,e),console.log("[DEBUG] App constructor");var s=localStorage.getItem("user_id");return n.state={bot:void 0,user_id:s,validUser:!1,password:""},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){console.log("app mounted");var e=U.a.get("csrftoken");O.a.defaults.headers.common["X-CSRFToken"]=e,console.log("[DEBUG] CSRFToken: ",e),window.p_url="https://docs.google.com/presentation/d/1icwHRx5HRxenKaI8-enVbBncDGEWzixOiL7NkqZvD5g/"}},{key:"handlePassChange",value:function(e){"10891089"==e.target.value&&(this.setState({validUser:!0}),window.localStorage.setItem("validUser","true"))}},{key:"login",value:function(){O.a.post("/api/v1/login/",{email:"brebiv@gmail.com",password:"10891089"}).then((function(e){localStorage.setItem("user_id",e.data.user_id),localStorage.setItem("bot_id",e.data.bot_id),document.location.href="/dashboard"}))}},{key:"logout",value:function(){O.a.get("/api/v1/logout/").then((function(e){console.log(e.data)}))}},{key:"render",value:function(){var e=this;return 0==this.state.validUser&&void 0==window.localStorage.getItem("validUser")?Object(u.jsx)("div",{children:Object(u.jsx)("input",{type:"password",onChange:function(t){e.handlePassChange(t)}})}):null==this.state.user_id?Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"Not logged in"}),Object(u.jsx)("button",{onClick:function(){return e.login()},children:"Login"})]}):Object(u.jsxs)(h.a,{children:[Object(u.jsx)(j,{}),Object(u.jsx)(b.a,{path:"/dashboard",component:function(){return Object(u.jsx)(f,{user_id:e.state.user_id})}}),Object(u.jsx)(b.a,{path:"/builder",component:function(){return Object(u.jsx)(N,{bot:e.state.bot})}}),Object(u.jsx)(b.a,{path:"/stat",component:function(){return Object(u.jsx)(H,{})}})]})}}]),a}(s.a.Component);a(193);i.a.render(Object(u.jsx)(P,{}),document.getElementById("root"))}},[[194,1,2]]]);
//# sourceMappingURL=main.58241c7a.chunk.js.map